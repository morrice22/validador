<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Validador de Certificados - FACITEC</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- CSS original incorporado -->
  <style>
    /* Reset básico */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    /* Estilo da página */
    body {
        font-family: 'Arial', sans-serif;
        background: linear-gradient(135deg, hsl(221, 100%, 32%), hsl(221, 100%, 50%)); /* Gradiente de fundo */
        color: #fff;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;

    }

    /* Container principal */
    .container {
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        padding: 40px;
        width: 100%;
        max-width: 450px;
        text-align: center;
        transition: all 0.3s ease;
    }

    .container:hover {
        transform: scale(1.02);
    }

    /* Cabeçalho com logo */
    header {
        margin-bottom: 30px;
    }

    .logo {
        width: 180px;
        height: auto;
        margin-bottom: 25px;
    }

    /* Título principal */
    h1 {
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 15px;
        color: #343a40;
        letter-spacing: 1px;
    }

    /* Estilo do campo de entrada */
    .input-container {
        display: flex;
        justify-content: center;
        margin-bottom: 25px;
    }

    input[type="text"] {
        padding: 12px 20px;
        width: 70%;
        border: 2px solid #ccc;
        border-radius: 8px;
        font-size: 16px;
        color: #333;
        transition: border 0.3s ease;
    }

    input[type="text"]:focus {
        border-color: #007bff;
        outline: none;
    }

    /* Botão */
    button {
        padding: 12px 25px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        cursor: pointer;
        width: 70%;
        transition: background-color 0.3s ease, transform 0.3s ease;
    }

    button:hover {
        background-color: #0056b3;
        transform: translateY(-2px);
    }

    button:active {
        transform: translateY(2px);
    }

    /* Estilo da mensagem de resultado */
    #result {
        font-size: 18px;
        margin-top: 15px;
        color: #333;
        text-align: left;
        line-height: 1.6;
    }

    /* Estilo das mensagens de erro e sucesso */
    .error {
        color: #e74c3c;
        font-weight: bold;
    }

    .success {
        color: #2ecc71;
        font-weight: bold;
    }

    /* Adicionando espaçamento entre as informações */
    .result-info {
        margin-bottom: 12px;
    }

    /* Tornando em negrito as palavras importantes */
    .bold {
        font-weight: bold;
    }

    /* Ajustando o estilo da parte de informações */
    .info-label {
        font-weight: bold;
        margin-top: 5px;
    }

    /* Estilo do texto explicativo */
    .explanation {
        font-size: 14px;
        margin-top: 20px;
        color: #333;
        font-style: italic;
    }
  </style>
  <!-- Manter a fonte do Google usada no novo site, caso necessária para ícones -->
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
  <!-- Favicon do site original -->
  <link rel="icon" href="https://raw.githubusercontent.com/morrice22/ico/refs/heads/main/favicon.ico" type="image/x-icon">
  <style>
    /* Estilos adicionais para elementos específicos do novo site que não estão no CSS original */
    .validador-certificado-valido {
      background-color: #ffffff; /* Fundo branco para a caixa de resultado */
      border: 1px solid #eee; /* Borda suave */
      border-radius: 8px; /* Bordas arredondadas consistentes */
      padding: 20px;
      margin-top: 20px;
      text-align: left;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      color: #333; /* Cor do texto padrão do container */
      line-height: 1.6;
    }

    .validador-certificado-valido p {
      margin: 8px 0;
    }

    .material-symbols-outlined {
      font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
      font-size: 22px;
      vertical-align: middle;
      color: #2ecc71; /* Cor verde para ícone de sucesso */
    }

    .aluno-destaque {
      background-color: #e7f5ff; /* Fundo azul claro suave */
      padding: 4px 8px;
      border-radius: 4px;
      color: #007bff; /* Cor azul do botão */
      text-decoration: none;
      font-weight: bold;
      display: inline-block;
      transition: background-color 0.3s ease;
    }

    .aluno-destaque:hover {
      background-color: #d0eaff;
    }

    /* Ajuste para garantir que o container não herde a cor de texto branca do body */
    .container {
        color: #333; /* Cor de texto padrão para o conteúdo dentro do container */
    }
    .container p {
        color: #555; /* Cor para parágrafos dentro do container */
    }
  </style>
</head>
<body>
  <!-- Estrutura principal adaptada do site original -->
  <div class="container">
    <header>
        <img src="https://i.imgur.com/cyfqmP7.png" alt="Logo" class="logo"> <!-- Logo do site original -->
    </header>

    <h1>Validação de Certificado</h1> <!-- Título do site original -->
    <p>Digite o ID do certificado, CPF ou Email:</p> <!-- Instrução adaptada -->

    <!-- Formulário adaptado para usar classes do CSS original -->
    <form id="search-form" style="margin-bottom: 25px;"> <!-- Adicionado margin-bottom para espaçamento -->
      <div class="input-container">
          <!-- Input com ID adaptado para JS e classes do CSS original -->
          <input type="text" id="certCode" name="valorBusca" required placeholder="Digite ID, CPF ou Email">
      </div>
      <!-- Botão usará o estilo padrão do CSS original -->
      <button type="submit">Validar</button>
    </form>

    <!-- Div de resultado com ID do CSS original -->
    <div id="result"></div>

  </div> <!-- Fim .container -->

<script>
  // Script do novo site com IDs de elementos atualizados
  const webAppUrl = 'https://script.google.com/macros/s/AKfycbwalxZL2Qy2Nr85Up4SIuKS7gbVlfFANDjm58aHqjyXz09cFxs0Q7b1A33w_WoIfJC-/exec';

  function buscarCertificado(valorBusca) {
    if (!valorBusca) return;

    const url = webAppUrl + "?valorBusca=" + encodeURIComponent(valorBusca);
    // Seleciona a div de resultado com o ID do CSS original
    const resultsContainer = document.getElementById("result");
    resultsContainer.innerHTML = "<div class='info'>Buscando...</div>"; // Mensagem de carregamento simples

    fetch(url)
      .then(response => response.json())
      .then(data => {

        if (!data || data.error) {
          // Usa a classe de erro do CSS original
          resultsContainer.innerHTML = `<div class='error'>${data.error || "❌ Código não encontrado."}</div>`;
          return;
        }

        // Limpa o container antes de adicionar novos resultados
        resultsContainer.innerHTML = '';

        const exibir = certificado => {
          const div = document.createElement("div");
          // Usa a classe específica do novo site para estilizar o bloco de sucesso
          div.className = "validador-certificado-valido";

          const cursoCompleto = certificado.nome_curso || "";
          const cursoSplit = cursoCompleto.split(" - ");
          const nomeCurso = cursoSplit[0];
          const dataCurso = cursoSplit.length > 1 ? cursoSplit.slice(1).join(" - ").trim() : "";

          // Estrutura de exibição do novo site
          div.innerHTML = `
            <div style="display: flex; align-items: center; gap: 8px; font-weight: bold; font-size: 16px; margin-bottom: 12px; color: #2ecc71;">
              <span class="material-symbols-outlined">verified</span>
              CERTIFICADO RECONHECIDO
            </div>
            <p><strong>Id Certificado:</strong> ${certificado.id_certificado}</p>
            <p><a href="${certificado.validacao}" target="_blank" class="aluno-destaque">✅ ${certificado.nome_aluno}</a></p>
            <p><strong>Curso:</strong> ${nomeCurso}</p>
            ${dataCurso ? `<p><strong>Período:</strong> ${dataCurso}</p>` : ""}
          `;

          resultsContainer.appendChild(div);
        };

        // Processa um ou múltiplos certificados
        Array.isArray(data) ? data.forEach(exibir) : exibir(data);
      })
      .catch(error => {
        console.error("❌ Erro na busca:", error);
        // Usa a classe de erro do CSS original
        resultsContainer.innerHTML = `<div class='error'>Erro de conexão ao buscar dados. Tente novamente.</div>`;
      });
  }

  // Adiciona listener ao formulário
  document.getElementById("search-form").addEventListener("submit", function(event) {
    event.preventDefault();
    // Pega o valor do input com ID adaptado
    const valor = document.getElementById("certCode").value.trim();
    buscarCertificado(valor);
  });

  // Verifica parâmetros na URL ao carregar
  document.addEventListener("DOMContentLoaded", function() {
    const param = new URLSearchParams(window.location.search).get("valorBusca");
    if (param) {
      // Define o valor no input com ID adaptado
      document.getElementById("certCode").value = param;
      buscarCertificado(param);
    }
  });
</script>
</body>
</html>
